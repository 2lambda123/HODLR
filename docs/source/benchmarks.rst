**********
Benchmarks
**********

All the following benchmarks have been carried out on an i7-8750H(with OpenMP enabled, this is 12 threads), with Intel's icpc (ICC) 19.0.1.144 compiler and Eigen version 3.3.7, with ``DTYPE`` set to ``double``. The compiler flags that were utilized are the same are those mentioned in the ``CMakeLists.txt`` file.

Presented below are the results as obtained when using different kernels:

Gaussian Kernel
###############

The Gaussian Kernel is given by :math:`K(i, j) = \sigma^2 \delta_{ij}^2 + \exp(-||x_i - x_j||^2)`. For these benchmarks, we take :math:`\sigma = 10` with :math:`x` being set as a sorted random vector :math:`\in (-1, 1)`. Using the ``plotTree`` function of this library, we can look at the rank structure for this matrix. The following diagram is obtained with :math:`N = 10000`, :math:`M = 500` and tolerance :math:`10^{-12}`

.. image:: images/gaussian_rank_structure.svg
   :width: 400

The green blocks are low-rank blocks. Their intensity of color shows their degree of "low-rankedness". Additionally, the rank has been displayed in each of these blocks. The red blocks are full-rank blocks and would have the rank of :math:`M = 500`

Time Taken vs Tolerance
~~~~~~~~~~~~~~~~~~~~~~~

For these benchmarks the size of the matrix :math:`N = 1000000`, with the size of the leaf node set to :math:`M = 100`.

Fast Factorization
^^^^^^^^^^^^^^^^^^

+----------------+------------+---------+------------+--------+--------------+
|Tolerance       | Assembly(s)|MatVec(s)|Factorize(s)|Solve(s)|Determinant(s)|
+================+============+=========+============+========+==============+ 
|:math:`10^{-2}` | 1.65059    |11.4442  |1.47112     |0.321805|0.0300901     |
+----------------+------------+---------+------------+--------+--------------+ 
|:math:`10^{-4}` | 1.82825    |8.33693  |1.94887     |0.337377|0.03039       |
+----------------+------------+---------+------------+--------+--------------+ 
|:math:`10^{-6}` | 1.92681    |12.4077  |2.33157     |0.346198|0.0300648     |
+----------------+------------+---------+------------+--------+--------------+
|:math:`10^{-8}` | 2.09475    |11.5901  |2.74718     |0.361579|0.0338411     |
+----------------+------------+---------+------------+--------+--------------+ 
|:math:`10^{-10}`| 2.28711    |11.8123  |3.22611     |0.375279|0.0296249     |
+----------------+------------+---------+------------+--------+--------------+ 
|:math:`10^{-12}`| 2.54764    |11.2157  |3.89779     |0.398319|0.0305111     |
+----------------+------------+---------+------------+--------+--------------+ 
|:math:`10^{-14}`| 2.95124    |8.55489  |5.01199     |0.431082|0.0309851     | 
+----------------+------------+---------+------------+--------+--------------+ 

.. image:: images/gaussian1.png
   :width: 600

Fast Symmetric Factorization
^^^^^^^^^^^^^^^^^^^^^^^^^^^^

+----------------+------------+---------+------------+--------+--------------+----------------+
|Tolerance       | Assembly(s)|MatVec(s)|Factorize(s)|Solve(s)|Determinant(s)|MultSymFactor(s)|
+================+============+=========+============+========+==============+================+ 
|:math:`10^{-2}` | 1.61076    |11.4741  |1.17726     |0.387992|0.0366111     |0.226509        |
+----------------+------------+---------+------------+--------+--------------+----------------+ 
|:math:`10^{-4}` | 1.81511    |8.08747  |1.56692     |0.399085|0.0328679     |0.249969        |
+----------------+------------+---------+------------+--------+--------------+----------------+ 
|:math:`10^{-6}` | 1.91956    |12.3341  |1.83361     |0.418334|0.031215      |0.266352        |
+----------------+------------+---------+------------+--------+--------------+----------------+ 
|:math:`10^{-8}` | 2.07343    |11.2653  |2.29376     |0.440591|0.0327439     |0.288697        |
+----------------+------------+---------+------------+--------+--------------+----------------+ 
|:math:`10^{-10}`| 2.24097    |11.7877  |2.86431     |0.464687|0.0305729     |0.339399        |
+----------------+------------+---------+------------+--------+--------------+----------------+ 
|:math:`10^{-12}`| 2.57603    |11.3027  |3.66516     |0.494536|0.031522      |0.393104        |
+----------------+------------+---------+------------+--------+--------------+----------------+ 
|:math:`10^{-14}`| 2.90611    |7.89484  |4.93738     |0.537149|0.030225      |0.393285        | 
+----------------+------------+---------+------------+--------+--------------+----------------+ 

.. image:: images/gaussian2.png
   :width: 600


Time Taken vs Size of Matrix
~~~~~~~~~~~~~~~~~~~~~~~~~~~~

For these benchmarks, the leaf size was fixed at :math:`M = 100`, with tolerance set to :math:`10^{-12}`

Fast Factorization
^^^^^^^^^^^^^^^^^^

+-----------------------+------------+------------+------------+-----------+--------------+----------------+
|:math:`N`              | Assembly(s)|MatVec(s)   |Factorize(s)|Solve(s)   |Determinant(s)|Direct LU(s)    |
+=======================+============+============+============+===========+==============+================+
|:math:`10^{3}`         | 0.00345016 |0.000463963 |0.00121403  |0.000246048|2.09808e-05   |0.024302        |
+-----------------------+------------+------------+------------+-----------+--------------+----------------+
|:math:`5 \times 10^{3}`| 0.00954294 |0.000818014 |0.00755906  |0.00179601 |0.000159979   |1.61282         |
+-----------------------+------------+------------+------------+-----------+--------------+----------------+
|:math:`10^{4}`         | 0.0180159  |0.00202203  |0.103507    |0.003834   |0.000344992   |10.4102         |
+-----------------------+------------+------------+------------+-----------+--------------+----------------+
|:math:`5 \times 10^{4}`| 0.109816   |0.0147851   |0.103266    |0.022316   |0.00227404    |N/A             |
+-----------------------+------------+------------+------------+-----------+--------------+----------------+
|:math:`10^{5}`         | 0.202525   |0.066885    |0.239639    |0.0450559  |0.00451112    |N/A             |
+-----------------------+------------+------------+------------+-----------+--------------+----------------+
|:math:`5 \times 10^{5}`| 1.19365    |3.68382     |1.6615      |0.206754   |0.015748      |N/A             |
+-----------------------+------------+------------+------------+-----------+--------------+----------------+
|:math:`10^{6}`         | 2.53519    |11.1435     |3.93549     |0.399695   |0.0303771     |N/A             |
+-----------------------+------------+------------+------------+-----------+--------------+----------------+

.. image:: images/gaussian3.png
   :width: 600

Fast Symmetric Factorization
^^^^^^^^^^^^^^^^^^^^^^^^^^^^

+-----------------------+------------+-----------+------------+----------+--------------+----------------+------------------+
|:math:`N`              | Assembly(s)|MatVec(s)  |Factorize(s)|Solve(s)  |Determinant(s)|MultSymFactor(s)|Direct Cholesky(s)|
+=======================+============+===========+============+==========+==============+================+==================+
|:math:`10^{3}`         | 0.00344396 |0.000510931|0.00103807  |0.00030303|2.19345e-05   |0.000180006     |0.0316679         |
+-----------------------+------------+-----------+------------+----------+--------------+----------------+------------------+
|:math:`5 \times 10^{3}`| 0.00925708 |0.000812054|0.00626493  |0.00209403|0.000108004   |0.00113392      |2.35399           |
+-----------------------+------------+-----------+------------+----------+--------------+----------------+------------------+
|:math:`10^{4}`         | 0.0183232  |0.00199389 |0.010865    |0.00471711|0.000352859   |0.00263691      |18.5745           |
+-----------------------+------------+-----------+------------+----------+--------------+----------------+------------------+
|:math:`5 \times 10^{4}`| 0.0946209  |0.0151899  |0.0787759   |0.0285201 |0.00230503    |0.0157571       |N/A               |
+-----------------------+------------+-----------+------------+----------+--------------+----------------+------------------+
|:math:`10^{5}`         | 0.203769   |0.0659761  |0.183974    |0.058074  |0.00438595    |0.03263         |N/A               |
+-----------------------+------------+-----------+------------+----------+--------------+----------------+------------------+
|:math:`5 \times 10^{5}`| 1.18639    |3.67825    |1.47418     |0.245743  |0.0180571     |0.162066        |N/A               |
+-----------------------+------------+-----------+------------+----------+--------------+----------------+------------------+
|:math:`10^{6}`         | 2.53567    |11.2973    |3.56786     |0.488049  |0.0311899     |0.377352        |N/A               |
+-----------------------+------------+-----------+------------+----------+--------------+----------------+------------------+

.. image:: images/gaussian4.png
   :width: 600

Mat√©rn Kernel
#############

Kernel considered is given by :math:`K(r) = \sigma^2 \left(1 + \frac{r \sqrt{5}}{\rho} + \frac{5 r^2}{3 \rho^2}\right)\exp{\left(-\frac{r \sqrt{5}}{\rho}\right)}`. For these benchmarks, we take :math:`\sigma = 10`, :math:`\rho = 5`, where :math:`r = ||x_i - x_j||` with :math:`x` being set as a sorted random vector :math:`\in (-1, 1)`. Using ``plotTree`` for :math:`N = 10000`, :math:`M = 500` and tolerance :math:`10^{-12}`, we get this rank structure

.. image:: images/matern_rank_structure.svg
   :width: 400

Time Taken vs Tolerance
~~~~~~~~~~~~~~~~~~~~~~~

For these benchmarks the size of the matrix :math:`N = 1000000`, with the size of the leaf node set to :math:`M = 100`.

Fast Factorization
^^^^^^^^^^^^^^^^^^

+----------------+------------+---------+------------+--------+--------------+
|Tolerance       | Assembly(s)|MatVec(s)|Factorize(s)|Solve(s)|Determinant(s)|
+================+============+=========+============+========+==============+ 
|:math:`10^{-2}` | 1.70237    |13.8247  |1.3231      |0.388983|0.042177      |
+----------------+------------+---------+------------+--------+--------------+ 
|:math:`10^{-4}` | 1.93746    |14.0274  |1.37327     |0.401342|0.0430369     |
+----------------+------------+---------+------------+--------+--------------+ 
|:math:`10^{-6}` | 1.99264    |9.29146  |1.6509      |0.413971|0.0420959     |
+----------------+------------+---------+------------+--------+--------------+
|:math:`10^{-8}` | 2.04502    |13.6249  |1.80135     |0.417019|0.043962      |
+----------------+------------+---------+------------+--------+--------------+ 
|:math:`10^{-10}`| 2.08538    |14.7541  |2.1616      |0.455189|0.0420899     |
+----------------+------------+---------+------------+--------+--------------+ 
|:math:`10^{-12}`| 2.28954    |9.11655  |2.27049     |0.431815|0.043808      |
+----------------+------------+---------+------------+--------+--------------+ 
|:math:`10^{-14}`| 2.19898    |13.821   |2.74798     |0.466761|0.0431418     | 
+----------------+------------+---------+------------+--------+--------------+ 

.. image:: images/matern1.png
   :width: 600

Fast Symmetric Factorization
^^^^^^^^^^^^^^^^^^^^^^^^^^^^

+----------------+------------+---------+------------+--------+--------------+----------------+
|Tolerance       | Assembly(s)|MatVec(s)|Factorize(s)|Solve(s)|Determinant(s)|MultSymFactor(s)|
+================+============+=========+============+========+==============+================+ 
|:math:`10^{-2}` | 1.65146    |13.4722  |0.722689    |0.461396|0.0417881     |0.257583        |
+----------------+------------+---------+------------+--------+--------------+----------------+ 
|:math:`10^{-4}` | 1.87788    |13.6014  |0.778202    |0.471056|0.041806      |0.263908        |
+----------------+------------+---------+------------+--------+--------------+----------------+ 
|:math:`10^{-6}` | 1.93905    |8.81335  |0.836078    |0.478072|0.0427818     |0.268437        |
+----------------+------------+---------+------------+--------+--------------+----------------+ 
|:math:`10^{-8}` | 2.05821    |13.4592  |1.05975     |0.496589|0.0437939     |0.294927        |
+----------------+------------+---------+------------+--------+--------------+----------------+ 
|:math:`10^{-10}`| 2.0032     |14.3409  |1.31922     |0.507549|0.0424139     |0.296023        |
+----------------+------------+---------+------------+--------+--------------+----------------+ 
|:math:`10^{-12}`| 2.23442    |8.84984  |1.51609     |0.533495|0.0427949     |0.311331        |
+----------------+------------+---------+------------+--------+--------------+----------------+ 
|:math:`10^{-14}`| 2.18632    |13.6219  |1.95092     |0.551657|0.0439069     |0.342182        | 
+----------------+------------+---------+------------+--------+--------------+----------------+ 

.. image:: images/matern2.png
   :width: 600


Time Taken vs Size of Matrix
~~~~~~~~~~~~~~~~~~~~~~~~~~~~

For these benchmarks, the leaf size was fixed at :math:`M = 100`, with tolerance set to :math:`10^{-12}`

Fast Factorization
^^^^^^^^^^^^^^^^^^

+-----------------------+------------+---------+------------+--------+--------------+----------------+
|:math:`N`              | Assembly(s)|MatVec(s)|Factorize(s)|Solve(s)|Determinant(s)|Direct LU(s)    |
+=======================+============+=========+============+========+==============+================+
|:math:`10^{3}`         | 0.00927687 |0.0001921|0.0011642   |0.000297|3.19481e-05   |0.0489709       |
+-----------------------+------------+---------+------------+--------+--------------+----------------+
|:math:`5 \times 10^{3}`| 0.0159199  |0.0007879|0.00726509  |0.002069|0.000204086   |2.52755         |
+-----------------------+------------+---------+------------+--------+--------------+----------------+
|:math:`10^{4}`         | 0.026196   |0.0020630|0.0235729   |0.005370|0.000522852   |16.0086         |
+-----------------------+------------+---------+------------+--------+--------------+----------------+
|:math:`5 \times 10^{4}`| 0.098814   |0.0144801|0.106045    |0.027053|0.00375605    |                |
+-----------------------+------------+---------+------------+--------+--------------+----------------+
|:math:`10^{5}`         | 0.180091   |0.0756569|0.19264     |0.054170|0.00687695    |                |
+-----------------------+------------+---------+------------+--------+--------------+----------------+
|:math:`5 \times 10^{5}`| 1.10963    |3.33762  |0.943877    |0.234129|0.0219009     |                |
+-----------------------+------------+---------+------------+--------+--------------+----------------+
|:math:`10^{6}`         | 2.25833    |9.01339  |2.33021     |0.450053|0.041976      |                |
+-----------------------+------------+---------+------------+--------+--------------+----------------+

.. image:: images/matern3.png
   :width: 600

Fast Symmetric Factorization
^^^^^^^^^^^^^^^^^^^^^^^^^^^^

+-----------------------+------------+-----------+------------+----------+--------------+----------------+------------------+
|:math:`N`              | Assembly(s)|MatVec(s)  |Factorize(s)|Solve(s)  |Determinant(s)|MultSymFactor(s)|Direct Cholesky(s)|
+=======================+============+===========+============+==========+==============+================+==================+
|:math:`10^{3}`         | 0.0066328  |0.000208855|0.000833988 |0.00034499|2.81334e-05   |0.000160933     |0.0281229         |
+-----------------------+------------+-----------+------------+----------+--------------+----------------+------------------+
|:math:`5 \times 10^{3}`| 0.0103149  |0.000798941|0.00359011  |0.00228715|0.000156879   |0.00105405      |0.231569          |
+-----------------------+------------+-----------+------------+----------+--------------+----------------+------------------+
|:math:`10^{4}`         | 0.02724    |0.00200987 |0.0175741   |0.00552893|0.000396013   |0.00261402      |1.05882           |
+-----------------------+------------+-----------+------------+----------+--------------+----------------+------------------+
|:math:`5 \times 10^{4}`| 0.08972    |0.0151231  |0.044107    |0.034517  |0.00314713    |0.0162551       |N/A               |
+-----------------------+------------+-----------+------------+----------+--------------+----------------+------------------+
|:math:`10^{5}`         | 0.192696   |0.067266   |0.0933969   |0.0709021 |0.0061872     |0.0332701       |N/A               |
+-----------------------+------------+-----------+------------+----------+--------------+----------------+------------------+
|:math:`5 \times 10^{5}`| 1.09055    |3.2381     |0.612783    |0.263855  |0.024405      |0.151778        |N/A               |
+-----------------------+------------+-----------+------------+----------+--------------+----------------+------------------+
|:math:`10^{6}`         | 2.19711    |8.79683    |1.47177     |0.545244  |0.0434139     |0.310443        |N/A               |
+-----------------------+------------+-----------+------------+----------+--------------+----------------+------------------+

.. image:: images/matern4.png
   :width: 600

RPY Tensor
##########

:math:`\texttt{dim} = 1`
~~~~~~~~~~~~~~~~~~~~~~~~

.. image:: images/RPY_rank_structure_dim1.svg
   :width: 400

:math:`\texttt{dim} = 2`
~~~~~~~~~~~~~~~~~~~~~~~~

.. image:: images/RPY_rank_structure_dim2.svg
   :width: 400

:math:`\texttt{dim} = 3`
~~~~~~~~~~~~~~~~~~~~~~~~

.. image:: images/RPY_rank_structure_dim3.svg
   :width: 400
